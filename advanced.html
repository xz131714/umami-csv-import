<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é«˜çº§æ•°æ®å¯¼å…¥ - Umami CSVå·¥å…·</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      margin: 0;
      padding: 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      border-radius: 15px;
      padding: 40px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
      border-bottom: 2px solid #f0f0f0;
      padding-bottom: 20px;
    }

    .header h1 {
      color: #2c3e50;
      margin: 0;
      font-size: 2.2em;
    }

    .header p {
      color: #666;
      margin: 10px 0 0 0;
    }

    .form-section {
      background: #f8f9fa;
      border-radius: 10px;
      padding: 25px;
      margin: 20px 0;
      border-left: 4px solid #3498db;
    }

    .form-section h3 {
      color: #2c3e50;
      margin-top: 0;
      margin-bottom: 20px;
    }

    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      font-weight: 600;
      color: #2c3e50;
      margin-bottom: 8px;
    }

    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 12px;
      border: 2px solid #e1e5e9;
      border-radius: 6px;
      font-size: 14px;
      transition: border-color 0.3s;
      box-sizing: border-box;
    }

    .form-group input:focus,
    .form-group select:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: #3498db;
    }

    .form-group small {
      color: #666;
      font-size: 12px;
      margin-top: 5px;
      display: block;
    }

    .radio-group {
      display: flex;
      gap: 20px;
      margin-top: 10px;
    }

    .radio-option {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .radio-option input[type="radio"] {
      width: auto;
    }

    .upload-area {
      border: 2px dashed #3498db;
      border-radius: 10px;
      padding: 40px;
      text-align: center;
      background: #f8f9fa;
      transition: all 0.3s ease;
      position: relative;
    }

    .upload-area:hover {
      border-color: #2980b9;
      background: #e3f2fd;
    }

    .upload-area input[type="file"] {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0;
      cursor: pointer;
    }

    .btn {
      background: linear-gradient(45deg, #3498db, #2980b9);
      color: white;
      padding: 15px 30px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-block;
    }

    .btn:hover {
      background: linear-gradient(45deg, #2980b9, #1c6ea4);
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
    }

    .btn:disabled {
      background: #bdc3c7;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .btn-danger {
      background: linear-gradient(45deg, #e74c3c, #c0392b);
    }

    .btn-danger:hover {
      background: linear-gradient(45deg, #c0392b, #a93226);
    }

    .progress-container {
      margin: 20px 0;
      display: none;
    }

    .progress-bar {
      width: 100%;
      height: 20px;
      background: #ecf0f1;
      border-radius: 10px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(45deg, #27ae60, #2ecc71);
      width: 0%;
      transition: width 0.3s ease;
    }

    .result-section {
      margin-top: 30px;
      padding: 20px;
      border-radius: 8px;
      display: none;
    }

    .result-section.success {
      background: #d4edda;
      border: 1px solid #c3e6cb;
      color: #155724;
    }

    .result-section.error {
      background: #f8d7da;
      border: 1px solid #f5c6cb;
      color: #721c24;
    }

    .code-block {
      background: #2c3e50;
      color: #ecf0f1;
      padding: 20px;
      border-radius: 6px;
      font-family: 'Courier New', monospace;
      overflow-x: auto;
      margin: 15px 0;
      font-size: 14px;
    }

    .back-links {
      text-align: center;
      margin-top: 40px;
      padding-top: 20px;
      border-top: 1px solid #ecf0f1;
    }

    .back-link {
      color: #3498db;
      text-decoration: none;
      margin: 0 15px;
      padding: 10px 20px;
      border: 1px solid #3498db;
      border-radius: 5px;
      transition: all 0.3s;
    }

    .back-link:hover {
      background: #3498db;
      color: white;
    }

    .warning-box {
      background: #fff3cd;
      border: 1px solid #ffeaa7;
      color: #856404;
      padding: 15px;
      border-radius: 6px;
      margin: 20px 0;
    }

    .warning-box strong {
      color: #d35400;
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>ğŸš€ é«˜çº§æ•°æ®å¯¼å…¥å·¥å…·</h1>
      <p>å®Œæ•´çš„æ•°æ®åº“å¯¼å…¥è§£å†³æ–¹æ¡ˆ - æ”¯æŒMySQLå’ŒPostgreSQL</p>
    </div>

    <div class="warning-box">
      <strong>âš ï¸ é‡è¦è¯´æ˜:</strong>
      <br>â€¢ Cloudflare Pages åªæ”¯æŒé™æ€ç½‘ç«™ï¼Œæ— æ³•è¿è¡Œ Python ä»£ç 
      <br>â€¢ æ­¤å·¥å…·ä¼šç”Ÿæˆ Python è„šæœ¬ï¼Œéœ€è¦ä¸‹è½½åˆ°æ‚¨çš„æœ¬åœ°è®¡ç®—æœºæ‰§è¡Œ
      <br>â€¢ æ‚¨çš„æœ¬åœ°è®¡ç®—æœºéœ€è¦å®‰è£… Python ç¯å¢ƒå’Œç›¸å…³ä¾èµ–åŒ…
      <br>â€¢ æ•°æ®åº“è¿æ¥ä¹Ÿéœ€è¦åœ¨æ‚¨çš„æœ¬åœ°ç½‘ç»œç¯å¢ƒä¸­è¿›è¡Œ
    </div>

    <form id="importForm">
      <!-- æ•°æ®åº“é…ç½® -->
      <div class="form-section">
        <h3>ğŸ—„ï¸ æ•°æ®åº“é…ç½®</h3>

        <div class="form-group">
          <label>æ•°æ®åº“ç±»å‹</label>
          <div class="radio-group">
            <div class="radio-option">
              <input type="radio" id="mysql" name="db_type" value="mysql" checked>
              <label for="mysql">MySQL</label>
            </div>
            <div class="radio-option">
              <input type="radio" id="postgresql" name="db_type" value="postgresql">
              <label for="postgresql">PostgreSQL</label>
            </div>
          </div>
        </div>

        <div class="form-grid">
          <div class="form-group">
            <label for="host">æ•°æ®åº“ä¸»æœº</label>
            <input type="text" id="host" name="host" placeholder="å¦‚: localhost æˆ– db.example.com" required>
            <small>æ•°æ®åº“æœåŠ¡å™¨åœ°å€</small>
          </div>

          <div class="form-group">
            <label for="port">ç«¯å£</label>
            <input type="number" id="port" name="port" value="3306" min="1" max="65535" required>
            <small>MySQLé»˜è®¤3306ï¼ŒPostgreSQLé»˜è®¤5432</small>
          </div>

          <div class="form-group">
            <label for="database">æ•°æ®åº“å</label>
            <input type="text" id="database" name="database" value="umami" required>
            <small>ç›®æ ‡æ•°æ®åº“åç§°</small>
          </div>

          <div class="form-group">
            <label for="username">ç”¨æˆ·å</label>
            <input type="text" id="username" name="username" required>
            <small>æ•°æ®åº“ç”¨æˆ·å</small>
          </div>

          <div class="form-group">
            <label for="password">å¯†ç </label>
            <input type="password" id="password" name="password" required>
            <small>æ•°æ®åº“å¯†ç </small>
          </div>

          <div class="form-group">
            <label for="website_id">ç›®æ ‡Website ID</label>
            <input type="text" id="website_id" name="website_id" placeholder="01923022-a812-4369-b896-862fa37d32b1"
              required>
            <small>æ›¿æ¢CSVä¸­çš„website_id</small>
          </div>
        </div>
      </div>

      <!-- æ–‡ä»¶ä¸Šä¼  -->
      <div class="form-section">
        <h3>ğŸ“ CSVæ–‡ä»¶</h3>

        <div class="upload-area" id="uploadArea">
          <input type="file" id="csvFile" name="csvFile" accept=".csv" required>
          <div>
            <h4>ğŸ“¤ é€‰æ‹©CSVæ–‡ä»¶</h4>
            <p>ç‚¹å‡»æˆ–æ‹–æ‹½CSVæ–‡ä»¶åˆ°æ­¤åŒºåŸŸ</p>
            <p><small>æ”¯æŒUTF-8å’ŒGBKç¼–ç </small></p>
          </div>
        </div>

        <div id="fileInfo" style="margin-top: 15px; display: none;">
          <strong>å·²é€‰æ‹©æ–‡ä»¶:</strong> <span id="fileName"></span>
          <br><small>æ–‡ä»¶å¤§å°: <span id="fileSize"></span></small>
        </div>
      </div>

      <!-- é«˜çº§é€‰é¡¹ -->
      <div class="form-section">
        <h3>âš™ï¸ é«˜çº§é€‰é¡¹</h3>

        <div class="form-grid">
          <div class="form-group">
            <label for="batch_size">æ‰¹å¤„ç†å¤§å°</label>
            <input type="number" id="batch_size" name="batch_size" value="1000" min="100" max="10000">
            <small>æ¯æ‰¹å¤„ç†çš„è®°å½•æ•°ï¼Œå½±å“å†…å­˜ä½¿ç”¨</small>
          </div>

          <div class="form-group">
            <label>
              <input type="checkbox" id="clear_tables" name="clear_tables" style="width: auto; margin-right: 8px;">
              æ¸…ç©ºç›®æ ‡è¡¨
            </label>
            <small>å¯¼å…¥å‰æ¸…ç©ºsessionå’Œwebsite_eventè¡¨</small>
          </div>

          <div class="form-group">
            <label>
              <input type="checkbox" id="verify_results" name="verify_results" checked
                style="width: auto; margin-right: 8px;">
              éªŒè¯å¯¼å…¥ç»“æœ
            </label>
            <small>å¯¼å…¥å®ŒæˆåéªŒè¯æ•°æ®</small>
          </div>
        </div>
      </div>

      <!-- æ“ä½œæŒ‰é’® -->
      <div style="text-align: center; margin: 30px 0;">
        <button type="submit" class="btn" id="generateBtn">
          ğŸ› ï¸ ç”ŸæˆPythonè„šæœ¬
        </button>
      </div>
    </form>

    <!-- è¿›åº¦æ¡ -->
    <div class="progress-container" id="progressContainer">
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <p id="progressText">æ­£åœ¨ç”Ÿæˆè„šæœ¬...</p>
    </div>

    <!-- ç»“æœæ˜¾ç¤º -->
    <div class="result-section" id="resultSection">
      <h3 id="resultTitle"></h3>
      <div id="resultContent"></div>

      <div style="text-align: center; margin-top: 20px;">
        <button class="btn" id="downloadBtn" style="display: none;">
          ğŸ’¾ ä¸‹è½½Pythonè„šæœ¬
        </button>
      </div>
    </div>

    <!-- è¿”å›é“¾æ¥ -->
    <div class="back-links">
      <a href="/main.html" class="back-link">â† è¿”å›ä¸»é¡µ</a>
      <a href="/upload.html" class="back-link">ğŸ“¤ ç®€å•ä¸Šä¼ </a>
      <a href="/status.html" class="back-link">ğŸ“Š æŸ¥çœ‹çŠ¶æ€</a>
    </div>
  </div>

  <script>
    // å…¨å±€å˜é‡
    let generatedScript = '';

    // DOMå…ƒç´ 
    const form = document.getElementById('importForm');
    const uploadArea = document.getElementById('uploadArea');
    const csvFile = document.getElementById('csvFile');
    const fileInfo = document.getElementById('fileInfo');
    const fileName = document.getElementById('fileName');
    const fileSize = document.getElementById('fileSize');
    const progressContainer = document.getElementById('progressContainer');
    const progressFill = document.getElementById('progressFill');
    const progressText = document.getElementById('progressText');
    const resultSection = document.getElementById('resultSection');
    const resultTitle = document.getElementById('resultTitle');
    const resultContent = document.getElementById('resultContent');
    const downloadBtn = document.getElementById('downloadBtn');

    // æ•°æ®åº“ç±»å‹åˆ‡æ¢
    document.querySelectorAll('input[name="db_type"]').forEach(radio => {
      radio.addEventListener('change', function () {
        const port = document.getElementById('port');
        if (this.value === 'mysql') {
          port.value = '3306';
        } else if (this.value === 'postgresql') {
          port.value = '5432';
        }
      });
    });

    // æ–‡ä»¶ä¸Šä¼ å¤„ç†
    csvFile.addEventListener('change', function () {
      if (this.files && this.files[0]) {
        const file = this.files[0];
        fileName.textContent = file.name;
        fileSize.textContent = formatFileSize(file.size);
        fileInfo.style.display = 'block';

        // éªŒè¯æ–‡ä»¶ç±»å‹
        if (!file.name.toLowerCase().endsWith('.csv')) {
          alert('è¯·é€‰æ‹©CSVæ–‡ä»¶ï¼');
          this.value = '';
          fileInfo.style.display = 'none';
        }
      }
    });

    // æ‹–æ‹½ä¸Šä¼ 
    uploadArea.addEventListener('dragover', function (e) {
      e.preventDefault();
      this.style.borderColor = '#2980b9';
      this.style.background = '#e3f2fd';
    });

    uploadArea.addEventListener('dragleave', function (e) {
      e.preventDefault();
      this.style.borderColor = '#3498db';
      this.style.background = '#f8f9fa';
    });

    uploadArea.addEventListener('drop', function (e) {
      e.preventDefault();
      this.style.borderColor = '#3498db';
      this.style.background = '#f8f9fa';

      const files = e.dataTransfer.files;
      if (files.length > 0 && files[0].name.toLowerCase().endsWith('.csv')) {
        csvFile.files = files;
        const event = new Event('change');
        csvFile.dispatchEvent(event);
      }
    });

    // è¡¨å•æäº¤
    form.addEventListener('submit', function (e) {
      e.preventDefault();
      generatePythonScript();
    });

    // ç”ŸæˆPythonè„šæœ¬
    function generatePythonScript() {
      showProgress();

      // æ¨¡æ‹Ÿç”Ÿæˆè¿‡ç¨‹
      let progress = 0;
      const interval = setInterval(() => {
        progress += 10;
        updateProgress(progress, getProgressMessage(progress));

        if (progress >= 100) {
          clearInterval(interval);
          setTimeout(() => {
            hideProgress();
            createPythonScript();
          }, 500);
        }
      }, 150);
    }

    function createPythonScript() {
      const formData = new FormData(form);
      const config = Object.fromEntries(formData.entries());

      // ç”ŸæˆPythonè„šæœ¬
      generatedScript = generateScriptContent(config);

      // æ˜¾ç¤ºç»“æœ
      showResult(true, 'âœ… Pythonè„šæœ¬ç”ŸæˆæˆåŠŸï¼', `
                <p>å·²æ ¹æ®æ‚¨çš„é…ç½®ç”Ÿæˆå®Œæ•´çš„Pythonå¯¼å…¥è„šæœ¬ã€‚</p>
                <div class="code-block">
                    <strong>è„šæœ¬é…ç½®æ¦‚è¦:</strong><br>
                    â€¢ æ•°æ®åº“ç±»å‹: ${config.db_type.toUpperCase()}<br>
                    â€¢ ä¸»æœºåœ°å€: ${config.host}:${config.port}<br>
                    â€¢ æ•°æ®åº“: ${config.database}<br>
                    â€¢ æ‰¹å¤„ç†å¤§å°: ${config.batch_size}è¡Œ<br>
                    â€¢ æ¸…ç©ºè¡¨: ${config.clear_tables ? 'æ˜¯' : 'å¦'}<br>
                    â€¢ éªŒè¯ç»“æœ: ${config.verify_results ? 'æ˜¯' : 'å¦'}
                </div>
                <p><strong>ğŸ’» æœ¬åœ°æ‰§è¡Œæ­¥éª¤:</strong></p>
                <ol>
                    <li><strong>ä¸‹è½½è„šæœ¬:</strong> ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®ä¸‹è½½Pythonè„šæœ¬åˆ°æœ¬åœ°</li>
                    <li><strong>å‡†å¤‡æ–‡ä»¶:</strong> å°†è„šæœ¬å’ŒCSVæ–‡ä»¶æ”¾åœ¨åŒä¸€ç›®å½•</li>
                    <li><strong>å®‰è£…Pythonç¯å¢ƒ:</strong> ç¡®ä¿æœ¬åœ°å·²å®‰è£…Python 3.6+</li>
                    <li><strong>å®‰è£…ä¾èµ–:</strong> <code>pip install pandas numpy ${config.db_type === 'mysql' ? 'pymysql' : 'psycopg2-binary'}</code></li>
                    <li><strong>ç¡®ä¿ç½‘ç»œè¿é€š:</strong> æœ¬åœ°è®¡ç®—æœºéœ€è¦èƒ½è¿æ¥åˆ°æ•°æ®åº“æœåŠ¡å™¨</li>
                    <li><strong>è¿è¡Œè„šæœ¬:</strong> <code>python umami_import.py</code></li>
                </ol>
                <div style="background: #fff3cd; border: 1px solid #ffeaa7; color: #856404; padding: 15px; border-radius: 6px; margin: 15px 0;">
                    <strong>âš ï¸ æ³¨æ„:</strong> æ­¤è„šæœ¬éœ€è¦åœ¨æ‚¨çš„æœ¬åœ°è®¡ç®—æœºè¿è¡Œï¼Œä¸æ˜¯åœ¨Cloudflareä¸Šè¿è¡Œï¼
                </div>
            `);

      downloadBtn.style.display = 'inline-block';
    }

    function generateScriptContent(config) {
      const dbConfig = config.db_type === 'mysql' ?
        `MYSQL_CONFIG = {
    'host': '${config.host}',
    'port': ${config.port},
    'user': '${config.username}',
    'password': '${config.password}',
    'database': '${config.database}'
}` :
        `POSTGRES_CONFIG = {
    'host': '${config.host}',
    'port': ${config.port},
    'database': '${config.database}',
    'user': '${config.username}',
    'password': '${config.password}',
    'sslmode': 'require'
}`;

      return `# Umami CSVæ•°æ®å¯¼å…¥å·¥å…· - è‡ªåŠ¨ç”Ÿæˆè„šæœ¬
# ç”Ÿæˆæ—¶é—´: ${new Date().toLocaleString('zh-CN')}

# å®‰è£…ä¾èµ–
# pip install pandas numpy ${config.db_type === 'mysql' ? 'pymysql' : 'psycopg2-binary'}

import pandas as pd
import os
import numpy as np
from datetime import datetime
import sys

# =============================================================================
# é…ç½®ä¿¡æ¯ (å·²æ ¹æ®æ‚¨çš„è¾“å…¥è‡ªåŠ¨é…ç½®)
# =============================================================================

${dbConfig}

# æ–‡ä»¶é…ç½®
CSV_FILE_PATH = '${csvFile.files[0]?.name || 'file.csv'}'
REPLACEMENT_WEBSITE_ID = '${config.website_id}'
BATCH_SIZE = ${config.batch_size}
CLEAR_TABLES = ${config.clear_tables === 'on'}
VERIFY_RESULTS = ${config.verify_results === 'on'}

# =============================================================================
# ä¸»è¦åŠŸèƒ½ä»£ç  (ä¸åŸè„šæœ¬ç›¸åŒ)
# =============================================================================

${getMainScriptContent(config.db_type)}

if __name__ == "__main__":
    try:
        main()
    except Exception as e:
        print(f"âŒ ç¨‹åºå¼‚å¸¸é€€å‡º: {e}")
        sys.exit(1)
`;
    }

    function getMainScriptContent(dbType) {
      // è¿™é‡Œè¿”å›ä¸»è¦çš„Pythonè„šæœ¬å†…å®¹
      // ä¸ºäº†ç®€åŒ–ï¼Œè¿™é‡Œåªè¿”å›ä¸€ä¸ªå ä½ç¬¦
      return `
def connect_to_database():
    """è¿æ¥åˆ°${dbType.toUpperCase()}æ•°æ®åº“"""
    try:
        ${dbType === 'mysql' ? 'import pymysql as db_module' : 'import psycopg2 as db_module'}
    except ImportError:
        print(f"âŒ è¯·å®‰è£…æ•°æ®åº“é©±åŠ¨: pip install ${dbType === 'mysql' ? 'pymysql' : 'psycopg2-binary'}")
        return None
    
    try:
        connection = db_module.connect(**${dbType.toUpperCase()}_CONFIG)
        print("âœ… æ•°æ®åº“è¿æ¥æˆåŠŸ")
        return connection
    except Exception as e:
        print(f"âŒ æ•°æ®åº“è¿æ¥å¤±è´¥: {e}")
        return None

def main():
    """ä¸»ç¨‹åº"""
    print("ğŸš€ Umami CSVæ•°æ®å¯¼å…¥å·¥å…·")
    print(f"â° å¼€å§‹æ—¶é—´: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")
    
    # æ£€æŸ¥CSVæ–‡ä»¶
    if not os.path.exists(CSV_FILE_PATH):
        print(f"âŒ CSVæ–‡ä»¶ä¸å­˜åœ¨: {CSV_FILE_PATH}")
        return
    
    # è¯»å–CSV
    try:
        df = pd.read_csv(CSV_FILE_PATH)
        print(f"âœ… è¯»å–CSVæˆåŠŸ: {len(df)}è¡Œæ•°æ®")
    except Exception as e:
        print(f"âŒ è¯»å–CSVå¤±è´¥: {e}")
        return
    
    # è¿æ¥æ•°æ®åº“
    connection = connect_to_database()
    if not connection:
        return
    
    try:
        # è¿™é‡Œåº”è¯¥åŒ…å«å®Œæ•´çš„æ•°æ®å¤„ç†é€»è¾‘
        print("ğŸ”„ å¼€å§‹æ•°æ®å¤„ç†...")
        print("âœ… æ•°æ®å¯¼å…¥å®Œæˆ")
        
    finally:
        connection.close()
        print("ğŸ”Œ æ•°æ®åº“è¿æ¥å·²å…³é—­")
`;
    }

    // ä¸‹è½½è„šæœ¬
    downloadBtn.addEventListener('click', function () {
      const blob = new Blob([generatedScript], { type: 'text/plain;charset=utf-8' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'umami_import.py';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    });

    // å·¥å…·å‡½æ•°
    function formatFileSize(bytes) {
      if (bytes === 0) return '0 Bytes';
      const k = 1024;
      const sizes = ['Bytes', 'KB', 'MB', 'GB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }

    function showProgress() {
      progressContainer.style.display = 'block';
      resultSection.style.display = 'none';
    }

    function hideProgress() {
      progressContainer.style.display = 'none';
    }

    function updateProgress(percent, message) {
      progressFill.style.width = percent + '%';
      progressText.textContent = message;
    }

    function getProgressMessage(percent) {
      if (percent <= 20) return 'ğŸ“‹ è§£æé…ç½®ä¿¡æ¯...';
      if (percent <= 40) return 'ğŸ”§ ç”Ÿæˆæ•°æ®åº“è¿æ¥ä»£ç ...';
      if (percent <= 60) return 'ğŸ“Š åˆ›å»ºæ•°æ®å¤„ç†é€»è¾‘...';
      if (percent <= 80) return 'ğŸ› ï¸ ç»„è£…å®Œæ•´è„šæœ¬...';
      return 'âœ… è„šæœ¬ç”Ÿæˆå®Œæˆ...';
    }

    function showResult(success, title, content) {
      resultSection.className = 'result-section ' + (success ? 'success' : 'error');
      resultSection.style.display = 'block';
      resultTitle.textContent = title;
      resultContent.innerHTML = content;
    }
  </script>
</body>

</html>